<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>flexPTP: Compiling the library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="large-top-height.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flexPTP_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">flexPTP<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">An IEEE 1588 PTP implementation designed for microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('building.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Compiling the library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md0"></a>
Compiling</h1>
<p>The library can be built in IDE managed mode or using the built-in CMake support. Using CMake is highly recommended. More on that <a class="el" href="building.html">Compiling the library</a>.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
CMake managed building</h2>
<ol type="1">
<li>Add the flexPTP directory to the CMake project as a subdirectory.</li>
<li>Either pick a hardware port from pre-made ones (H743_LWIP, H743_ETHERLIB, F407_ETHERLIB, TM4C1294_LWIP) by setting the <code>FLEXPTP_HWPORT</code> CMake variable, or populate the <code>FLEXPTP_HWPORT_SRC</code> with the list of custom hardware port files. Bundled hardware ports can be automatically tailored to some compatible devices by specifying the MCU type (e.g. the STM32F407 port works with the STM32F439 device as well, so that setting <code>FLEXPTP_HWPORT</code> to <code>F439_{LWIP|ETHERLIB}}</code> makes flexPTP using the former port files).</li>
<li>Set the <code>FLEXPTP_NSD</code> to the Network Stack Driver files and the <code>FLEXPTP_NETWORK_STACK</code> to the name of the network library or pick from the predefined set (LWIP, ETHERLIB). In the latter case, do not populate <code>FLEXPTP_NETWORK_STACK</code>.</li>
<li><em>Optionally</em> select a predefined Clock servo algoritm (currently only PID is bundled) by setting the <code>FLEXPTP_SERVO</code> variable. If a custom servo is used, and the developer wants the servo to get compiled into the flexPTP library, then populate the <code>FLEXPTP_SERVO_SRC</code> variable with the list of custom servo files. Leaving both <code>FLEXPTP_SERVO</code> and <code>FLEXPTP_SERVO_SRC</code> variables empty results in a warning message during CMake configuration, however it does not necessarily results in a faulty operation. If servo functions are set correctly in the <code>flexptp_options.h</code> configuration file, then the linker will connect flexPTP and the custom servo.</li>
<li>Place a completed <code>flexptp_options.h</code> onto a location that is accessible for the flexPTP module. Set the <code>FLEXPTP_INCLUDES</code> CMake variable so that the former requirement is satisfied.</li>
<li><em>Optionally</em>, set <code>FLEXPTP_CPU_PARAMS</code> and <code>FLEXPTP_COMPILE_DEFS</code> to pass target CPU parameters and C definitions.</li>
</ol>
<p>Building this way results in a static library (<code>libflexptp</code>) that is managed by CMake. This library must be linked to the project's output. <em>Optionally</em>, the name of the output can be suffixed by a tag for reasons by setting the <code>FLEXPTP_TARGET_TAG</code>.</p>
<p>For more information about flexPTP's CMake variables, see <code>CMakeLists.txt</code>.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Example configuration:</h3>
<p>The following configuration instructs the flexPTP to:</p><ul>
<li>use the bundled STM32F407 hardware port with lwIP bindings</li>
<li>load the bundled lwIP network stack driver (and link against the <code>lwipcore</code> library)</li>
<li>select the bundled PID controller as the clock servo</li>
</ul>
<div class="fragment"><div class="line">set(FLEXPTP_HWPORT &quot;F407_LWIP&quot;)</div>
<div class="line">set(FLEXPTP_NSD &quot;LWIP&quot;)</div>
<div class="line">set(FLEXPTP_SERVO &quot;PID&quot;)</div>
</div><!-- fragment --><p>The CMake configuration output will be the following:</p>
<div class="fragment"><div class="line">[cmake] flexPTP: <span class="stringliteral">&#39;F407_LWIP&#39;</span> hardware port selected</div>
<div class="line">[cmake] flexPTP: <span class="stringliteral">&#39;LWIP&#39;</span> network stack driver selected</div>
<div class="line">[cmake] flexPTP: <span class="stringliteral">&#39;PID&#39;</span> clock servo selected</div>
<div class="line">[cmake] flexPTP: linking against <span class="stringliteral">&#39;lwipcore&#39;</span> network library</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md3"></a>
IDE managed or manual building</h2>
<ol type="1">
<li>Register all <code>*.c</code> and <code>*.h</code> files in the root folder as source file. Do NOT include the <code>hw_port</code> directory!</li>
<li>Add the hardware port files if necessary. If a decision was made to pick one of packaged hardware ports, then add <b>ONLY one pair</b> of <code>ptp_port_XXXX.c/h</code> files from the <code>hw_port</code> port directory to the buildset. Repeat the former method for the Network Stack Driver, the network stack library and for the Clock Servo.</li>
<li>Place a completed <code>flexptp_options.h</code> onto a location that is accessible for the compiler through the include path.</li>
</ol>
<p>This way the compilation target is determined by the build system. The build system's settings determine whether a static library is built or the flexPTP will be included into the project's output executable directly.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Precompiled library</h2>
<p>It is possible to build flexPTP separately as well. This way only header files and a precompiled library must be added to the project. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
